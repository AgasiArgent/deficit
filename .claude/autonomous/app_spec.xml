<?xml version="1.0" encoding="UTF-8"?>
<project_specification>
  <project_name>deficit</project_name>

  <overview>
    Telegram-–±–æ—Ç –¥–ª—è –ª–∏—á–Ω–æ–≥–æ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ç–µ–ª–∞ –∏ –∫–∞–ª–æ—Ä–∏–π —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤–Ω–æ—Å–∏—Ç –≤–µ—Å, –æ–±—ä–µ–º —Ç–∞–ª–∏–∏, –æ–±—ä–µ–º —à–µ–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–ª–æ—Ä–∏–π.
    –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Ö—É–¥–µ–Ω–∏—è.
  </overview>

  <technology_stack>
    <backend>
      <language>Python 3.11+</language>
      <framework>python-telegram-bot 20.7</framework>
      <database>SQLite with SQLAlchemy ORM</database>
      <scheduler>APScheduler (–¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π)</scheduler>
    </backend>
    <visualization>
      <library>matplotlib 3.8.2</library>
      <data_processing>pandas 2.1.4</data_processing>
    </visualization>
    <config>
      <env_management>python-dotenv 1.0.0</env_management>
    </config>
  </technology_stack>

  <prerequisites>
    <environment_setup>
      - Python 3.11 –∏–ª–∏ –≤—ã—à–µ
      - Telegram Bot Token (–æ—Ç @BotFather)
      - –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (venv)
      - –§–∞–π–ª .env —Å TELEGRAM_BOT_TOKEN
    </environment_setup>
  </prerequisites>

  <feature_count>27</feature_count>

  <security_and_access_control>
    <user_roles>
      <role name="owner">
        <permissions>
          - –í–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ
          - –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏
          - –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏
          - –ü–æ–ª—É—á–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
        </permissions>
      </role>
    </user_roles>
    <authentication>
      –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤–ª–∞–¥–µ–ª—å—Ü–∞).
      User ID –≤–ª–∞–¥–µ–ª—å—Ü–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ /start.
      –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É user_id –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
    </authentication>
  </security_and_access_control>

  <core_features>
    <infrastructure>
      - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞ –∏ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
      - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite –∏ –º–æ–¥–µ–ª–∏ SQLAlchemy
      - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –ú–°–ö (Europe/Moscow)
    </infrastructure>

    <reminders>
      - Scheduled job –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ 9:00 –ú–°–ö
      - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    </reminders>

    <data_entry>
      - –ö–æ–º–∞–Ω–¥–∞ /start: –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
      - –ö–æ–º–∞–Ω–¥–∞ /add: –∏–Ω–∏—Ü–∏–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
      - Conversation handler —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏:
        1. –í–µ—Å (–∫–≥)
        2. –û–±—ä–µ–º —Ç–∞–ª–∏–∏ (—Å–º)
        3. –û–±—ä–µ–º —à–µ–∏ (—Å–º)
        4. –ö–∞–ª–æ—Ä–∏–∏ –∑–∞ –≤—á–µ—Ä–∞
      - –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è (—á–∏—Å–ª–∞, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
      - –í—ã–±–æ—Ä –¥–∞—Ç—ã –∑–∞–ø–∏—Å–∏: —Å–µ–≥–æ–¥–Ω—è / –≤—á–µ—Ä–∞ / –ø–æ–∑–∞–≤—á–µ—Ä–∞ (inline –∫–Ω–æ–ø–∫–∏)
      - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î
      - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–≤–µ–¥–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    </data_entry>

    <visualization>
      - –ö–æ–º–∞–Ω–¥–∞ /graph: –ø–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Å –¥–∞–Ω–Ω—ã–º–∏
      - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PNG-–≥—Ä–∞—Ñ–∏–∫–∞ —Å 4 –ª–∏–Ω–∏—è–º–∏:
        * –í–µ—Å (–∫–≥) - –æ—Å–Ω–æ–≤–Ω–∞—è –æ—Å—å Y
        * –¢–∞–ª–∏—è (—Å–º) - –≤—Ç–æ—Ä–∏—á–Ω–∞—è –æ—Å—å Y —Å–ø—Ä–∞–≤–∞
        * –®–µ—è (—Å–º) - –≤—Ç–æ—Ä–∏—á–Ω–∞—è –æ—Å—å Y —Å–ø—Ä–∞–≤–∞
        * –ö–∞–ª–æ—Ä–∏–∏ - –≤—Ç–æ—Ä–∏—á–Ω–∞—è –æ—Å—å Y —Å–ø—Ä–∞–≤–∞
      - Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞: [–ù–µ–¥–µ–ª—è] [–ú–µ—Å—è—Ü] [2 –º–µ—Å—è—Ü–∞]
      - –û–±—Ä–∞–±–æ—Ç–∫–∞ callback –¥–ª—è —Å–º–µ–Ω—ã –ø–µ—Ä–∏–æ–¥–∞ (–ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞)
      - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ "–ù–∞—á–∞–ª—å–Ω—ã–π ‚Üí –¢–µ–∫—É—â–∏–π" –¥–ª—è –≤–µ—Å–∞, —Ç–∞–ª–∏–∏, —à–µ–∏
      - –ü–æ–∫–∞–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –¥–∞–∂–µ –µ—Å–ª–∏ –∑–∞–ø–∏—Å–µ–π –º–∞–ª–æ (—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º)
      - –û—Ç–ø—Ä–∞–≤–∫–∞ PNG-—Ñ–∞–π–ª–∞ –≤ —á–∞—Ç
    </visualization>

    <deletion>
      - –ö–æ–º–∞–Ω–¥–∞ /delete: –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –∑–∞–ø–∏—Å–µ–π
      - Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∑–∞–ø–∏—Å–∏ (—Ñ–æ—Ä–º–∞—Ç: "–¥–∞—Ç–∞ - –≤–µ—Å –∫–≥")
      - Callback –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è
      - –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –ë–î
      - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    </deletion>

    <error_handling>
      - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞ (–Ω–µ —á–∏—Å–ª–æ, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
      - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞—è –ø—É—Å—Ç–æ–π –ë–î –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –≥—Ä–∞—Ñ–∏–∫–∞
      - Graceful fallback –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
    </error_handling>
  </core_features>

  <database_schema>
    <tables>
      <measurements>
        - id: INTEGER PRIMARY KEY AUTOINCREMENT
        - user_id: BIGINT (Telegram user ID)
        - date: DATE (–¥–∞—Ç–∞ –∑–∞–º–µ—Ä–∞)
        - weight: REAL (–≤–µ—Å –≤ –∫–≥)
        - waist: REAL (—Ç–∞–ª–∏—è –≤ —Å–º)
        - neck: REAL (—à–µ—è –≤ —Å–º)
        - calories: INTEGER (–∫–∞–ª–æ—Ä–∏–∏ –∑–∞ –¥–µ–Ω—å)
        - created_at: TIMESTAMP (–≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏)

        Constraints:
        - UNIQUE(user_id, date) - –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –Ω–∞ –¥–µ–Ω—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        - INDEX –Ω–∞ user_id –∏ date –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
      </measurements>
    </tables>
  </database_schema>

  <api_endpoints_summary>
    <bot_commands>
      - /start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
      - /add - –ù–∞—á–∞—Ç—å –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö (conversation)
      - /graph - –ü–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫
      - /delete - –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å
    </bot_commands>

    <callback_handlers>
      - date_selection: —Å–µ–≥–æ–¥–Ω—è|–≤—á–µ—Ä–∞|–ø–æ–∑–∞–≤—á–µ—Ä–∞
      - period_selection: week|month|two_months
      - delete_record: delete_{record_id}
    </callback_handlers>
  </api_endpoints_summary>

  <ui_layout>
    <screen name="–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ (/start)">
      - –ó–∞–≥–æ–ª–æ–≤–æ–∫: "üëã –ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ç–µ–ª–∞"
      - –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥:
        * /add - –≤–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ
        * /graph - –ø–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫
        * /delete - —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å
      - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 –ú–°–ö —è –±—É–¥—É –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å –≤–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ"
    </screen>

    <screen name="–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö (/add)">
      - –®–∞–≥ 1: "–í–≤–µ–¥–∏ –≤–µ—Å (–∫–≥):" ‚Üí –∂–¥–µ–º —á–∏—Å–ª–æ
      - –®–∞–≥ 2: "–í–≤–µ–¥–∏ –æ–±—ä–µ–º —Ç–∞–ª–∏–∏ (—Å–º):" ‚Üí –∂–¥–µ–º —á–∏—Å–ª–æ
      - –®–∞–≥ 3: "–í–≤–µ–¥–∏ –æ–±—ä–µ–º —à–µ–∏ (—Å–º):" ‚Üí –∂–¥–µ–º —á–∏—Å–ª–æ
      - –®–∞–≥ 4: "–í–≤–µ–¥–∏ –∫–∞–ª–æ—Ä–∏–∏ –∑–∞ –≤—á–µ—Ä–∞:" ‚Üí –∂–¥–µ–º —á–∏—Å–ª–æ
      - –®–∞–≥ 5: "–ó–∞ –∫–∞–∫–æ–π –¥–µ–Ω—å –∑–∞–ø–∏—Å–∞—Ç—å?" ‚Üí –∫–Ω–æ–ø–∫–∏ [–°–µ–≥–æ–¥–Ω—è] [–í—á–µ—Ä–∞] [–ü–æ–∑–∞–≤—á–µ—Ä–∞]
      - –†–µ–∑—É–ª—å—Ç–∞—Ç: "‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: [–¥–∞—Ç–∞] - –≤–µ—Å, —Ç–∞–ª–∏—è, —à–µ—è, –∫–∞–ª–æ—Ä–∏–∏"
    </screen>

    <screen name="–ì—Ä–∞—Ñ–∏–∫ (/graph)">
      - PNG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ (800x600px)
      - –õ–µ–≥–µ–Ω–¥–∞ —Å 4 –ª–∏–Ω–∏—è–º–∏ —Ä–∞–∑–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤
      - –¢–µ–∫—Å—Ç –Ω–∞–¥ –≥—Ä–∞—Ñ–∏–∫–æ–º:
        * "–í–µ—Å: [–Ω–∞—á–∞–ª—å–Ω—ã–π]–∫–≥ ‚Üí [—Ç–µ–∫—É—â–∏–π]–∫–≥ ([¬±X]–∫–≥)"
        * "–¢–∞–ª–∏—è: [–Ω–∞—á–∞–ª—å–Ω—ã–π]—Å–º ‚Üí [—Ç–µ–∫—É—â–∏–π]—Å–º ([¬±X]—Å–º)"
        * "–®–µ—è: [–Ω–∞—á–∞–ª—å–Ω—ã–π]—Å–º ‚Üí [—Ç–µ–∫—É—â–∏–π]—Å–º ([¬±X]—Å–º)"
      - Inline –∫–Ω–æ–ø–∫–∏: [üìÖ –ù–µ–¥–µ–ª—è] [üìÖ –ú–µ—Å—è—Ü] [üìÖ 2 –º–µ—Å—è—Ü–∞]
    </screen>

    <screen name="–£–¥–∞–ª–µ–Ω–∏–µ (/delete)">
      - –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–í—ã–±–µ—Ä–∏ –∑–∞–ø–∏—Å—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:"
      - 5 inline –∫–Ω–æ–ø–æ–∫ —Å –∑–∞–ø–∏—Å—è–º–∏:
        * "[–¥–∞—Ç–∞] - [–≤–µ—Å]–∫–≥, [—Ç–∞–ª–∏—è]—Å–º, [—à–µ—è]—Å–º"
      - –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞: "–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∑–∞ [–¥–∞—Ç–∞]?" ‚Üí [–î–∞] [–û—Ç–º–µ–Ω–∞]
      - –†–µ–∑—É–ª—å—Ç–∞—Ç: "üóëÔ∏è –ó–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∞"
    </screen>

    <screen name="–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (9:00 –ú–°–ö)">
      - "‚è∞ –ü–æ—Ä–∞ –≤–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞ —Å–µ–≥–æ–¥–Ω—è!"
      - "–ò—Å–ø–æ–ª—å–∑—É–π /add –¥–ª—è –≤–≤–æ–¥–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π"
    </screen>
  </ui_layout>

  <implementation_steps>
    <step number="1">
      <title>–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</title>
      <tasks>
        - –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
        - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SQLAlchemy –º–æ–¥–µ–ª–∏ (Measurement)
        - –°–æ–∑–¥–∞—Ç—å database.py —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ SQLite
        - –°–æ–∑–¥–∞—Ç—å init_db() —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
        - –î–æ–±–∞–≤–∏—Ç—å .env.example –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Ç–æ–∫–µ–Ω–∞
      </tasks>
    </step>

    <step number="2">
      <title>–ë–∞–∑–æ–≤—ã–π –±–æ—Ç –∏ –∫–æ–º–∞–Ω–¥—ã</title>
      <tasks>
        - –°–æ–∑–¥–∞—Ç—å main.py —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –±–æ—Ç–∞
        - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å /start —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º –∏ —Å–ø–∏—Å–∫–æ–º –∫–æ–º–∞–Ω–¥
        - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        - –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
      </tasks>
    </step>

    <step number="3">
      <title>–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö (Conversation Handler)</title>
      <tasks>
        - –°–æ–∑–¥–∞—Ç—å conversation handler –¥–ª—è /add
        - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–≤–µ—Å ‚Üí —Ç–∞–ª–∏—è ‚Üí —à–µ—è ‚Üí –∫–∞–ª–æ—Ä–∏–∏)
        - –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤–≤–æ–¥–∞
        - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä –¥–∞—Ç—ã (inline –∫–Ω–æ–ø–∫–∏)
        - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
        - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
      </tasks>
    </step>

    <step number="4">
      <title>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤</title>
      <tasks>
        - –°–æ–∑–¥–∞—Ç—å visualization.py —Å —Ñ—É–Ω–∫—Ü–∏–µ–π generate_chart()
        - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å /graph –∫–æ–º–∞–Ω–¥—É
        - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è matplotlib –≥—Ä–∞—Ñ–∏–∫–∞ —Å 4 –ª–∏–Ω–∏—è–º–∏
        - –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ "–Ω–∞—á–∞–ª—å–Ω—ã–π ‚Üí —Ç–µ–∫—É—â–∏–π"
        - Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–µ—Ä–∏–æ–¥–æ–≤
        - Callback handlers –¥–ª—è —Å–º–µ–Ω—ã –ø–µ—Ä–∏–æ–¥–∞
        - –û—Ç–ø—Ä–∞–≤–∫–∞ PNG –≤ —á–∞—Ç
      </tasks>
    </step>

    <step number="5">
      <title>–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π</title>
      <tasks>
        - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å /delete –∫–æ–º–∞–Ω–¥—É
        - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 5 –∑–∞–ø–∏—Å–µ–π –∏–∑ –ë–î
        - Inline –∫–Ω–æ–ø–∫–∏ —Å–æ —Å–ø–∏—Å–∫–æ–º
        - Callback handler –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
        - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
      </tasks>
    </step>

    <step number="6">
      <title>–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (APScheduler)</title>
      <tasks>
        - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å APScheduler —Å timezone Europe/Moscow
        - –î–æ–±–∞–≤–∏—Ç—å job –¥–ª—è 9:00 –ú–°–ö
        - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
        - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏
      </tasks>
    </step>

    <step number="7">
      <title>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–ª–∏—Ä–æ–≤–∫–∞</title>
      <tasks>
        - –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
        - –ü—Ä–æ–≤–µ—Ä–∫–∞ edge cases (–ø—É—Å—Ç–∞—è –ë–î, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥)
        - –£–ª—É—á—à–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
        - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ –¥–ª—è UX
        - –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
      </tasks>
    </step>
  </implementation_steps>

  <success_criteria>
    <functionality>
      - –í—Å–µ 4 –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫ (/start, /add, /graph, /delete)
      - Conversation handler –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
      - –ì—Ä–∞—Ñ–∏–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ 4 –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
      - –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 9:00 –ú–°–ö
      - –ú–æ–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞ —Å–µ–≥–æ–¥–Ω—è/–≤—á–µ—Ä–∞/–ø–æ–∑–∞–≤—á–µ—Ä–∞
      - –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
      - Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
    </functionality>

    <technical_quality>
      - –ö–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –ø–æ –º–æ–¥—É–ª—è–º (bot/, database/, visualization/)
      - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
      - –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
      - Graceful –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞
      - –ù–µ—Ç SQL injection (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLAlchemy ORM)
    </technical_quality>

    <user_experience>
      - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–Ω—è—Ç–Ω–æ–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ
      - –í–æ–ø—Ä–æ—Å—ã –≤ conversation –ø–æ–Ω—è—Ç–Ω—ã
      - –ì—Ä–∞—Ñ–∏–∫ —á–∏—Ç–∞–µ–º –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–µ–Ω
      - –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–µ–∑–Ω—ã–µ —ç–º–æ–¥–∑–∏
      - –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    </user_experience>
  </success_criteria>

  <file_structure>
    <structure>
deficit/
‚îú‚îÄ‚îÄ .env                        # –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ .env.example               # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .gitignore                 # Git ignore rules
‚îú‚îÄ‚îÄ requirements.txt           # Python dependencies
‚îú‚îÄ‚îÄ README.md                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers.py        # Command –∏ callback handlers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conversations.py   # Conversation handler –¥–ª—è /add
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ queries.py         # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ visualization/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ charts.py          # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è matplotlib –≥—Ä–∞—Ñ–∏–∫–æ–≤
‚îÇ
‚îî‚îÄ‚îÄ .claude/
    ‚îî‚îÄ‚îÄ autonomous/
        ‚îú‚îÄ‚îÄ app_spec.xml       # –≠—Ç–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
        ‚îú‚îÄ‚îÄ features.json      # –¢—Ä–µ–∫–∏–Ω–≥ —Ñ–∏—á
        ‚îú‚îÄ‚îÄ init.sh            # –ó–∞–ø—É—Å–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è
        ‚îî‚îÄ‚îÄ SESSION_PROTOCOL.md # –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è —Å–µ—Å—Å–∏–π
    </structure>
  </file_structure>

  <notes>
    <timezone>
      –í–ê–ñ–ù–û: –í—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å timezone Europe/Moscow (–ú–°–ö).
      APScheduler –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å pytz.timezone('Europe/Moscow').
    </timezone>

    <graph_design>
      –ì—Ä–∞—Ñ–∏–∫ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å:
      - –û—Å–Ω–æ–≤–Ω—É—é –æ—Å—å Y —Å–ª–µ–≤–∞ –¥–ª—è –≤–µ—Å–∞ (–∫–≥)
      - –í—Ç–æ—Ä–∏—á–Ω—É—é –æ—Å—å Y —Å–ø—Ä–∞–≤–∞ –¥–ª—è —Ç–∞–ª–∏–∏/—à–µ–∏/–∫–∞–ª–æ—Ä–∏–π
      - –†–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ª–∏–Ω–∏–π –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
      - –°–µ—Ç–∫—É –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —á—Ç–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
      - –õ–µ–≥–µ–Ω–¥—É —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
    </graph_design>

    <single_user>
      –ë–æ—Ç —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É user_id –≤ handlers –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥—Ä—É–≥–∏—Ö.
    </single_user>
  </notes>
</project_specification>
